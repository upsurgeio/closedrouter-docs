---
title: "Model Routing"
description: "Dynamically route requests to model."
---

### Auto Router

### The `models` parameter

The `models` parameter lets you provide an ordered list of models.\
If the first model is unavailable (due to rate limits, downtime, or moderation blocks), Pineapple will try the next one.

```json
{
  "model": "openai/gpt-4o",
  "models": ["anthropic/claude-3.5-sonnet", "mistral/mixtral-8x7b"],
  "...": "other params"
}
```

If the model you selected returns an error, Pineapple will try to use the fallback model instead. If the fallback model is down or returns an error, Pineapple will return that error.\
\
By default, any error can trigger the use of a fallback model, including context length validation errors, moderation flags for filtered models, rate-limiting, and downtime.\
\
Requests are priced using the model that was ultimately used, which will be returned in the `model` attribute of the response body.

### Using with OpenAI SDK

To use the `models` array with the OpenAI SDK, include it in the `extra_body` parameter.\
In the example below, `gpt-4o` will be tried first, then the fallbacks.

<CodeGroup>

```typescript typescript
import OpenAI from "openai";

const pineappleClient = new OpenAI({
  baseURL: "https://api.pineapple.ai/v1",
  apiKey: process.env.PINEAPPLE_API_KEY,
});

async function main() {
  // @ts-expect-error
  const completion = await pineappleClient.chat.completions.create({
    model: "openai/gpt-4o",
    models: ["anthropic/claude-3.5-sonnet", "mistral/mixtral-8x7b"],
    messages: [
      {
        role: "user",
        content: "What is the meaning of life?",
      },
    ],
  });

  console.log(completion.choices[0].message);
}

main();
```


```python python
from openai import OpenAI

client = OpenAI(
    base_url="https://api.pineapple.ai/v1",
    api_key={{API_KEY_REF}},
)

completion = client.chat.completions.create(
    model="openai/gpt-4o",
    extra_body={
        "models": ["anthropic/claude-3.5-sonnet", "mistral/mixtral-8x7b"],
    },
    messages=[
        {
            "role": "user",
            "content": "What is the meaning of life?"
        }
    ]
)

print(completion.choices[0].message.content)
```

</CodeGroup>